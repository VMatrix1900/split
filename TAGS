
proxy/cachetgcrt.h,42
#define CACHETGCRT_HCACHETGCRT_H30,1477

proxy/SSL_layer.c,427
send_down(struct proxy *proxy, int server) {send_down19,562
receive_up(SSL* ssl, unsigned char *shm) {receive_up51,1887
forward_record(SSL *from, SSL *to, struct proxy *proxy) {forward_record64,2279
peek_hello_msg(struct proxy *proxy, unsigned char *msg) {peek_hello_msg147,4945
proxy_new(struct ssl_channel *ctx, int index) {proxy_new173,5954
create_channel_ctx() {create_channel_ctx195,6582
main ()main212,7057

proxy/makefile,671
BINDIR := ../binBINDIR1,0
BUILDDIR := ../buildBUILDDIR2,17
CC := gccCC3,38
SSL_LIB := -I/home/vincent/Downloads/openssl-1.0.1i/include -L/home/vincent/Downloads/openssl-1.0.1iSSL_LIB4,48
CFLAGS := -g -Wall -Wextra -std=c99 -pthread -fstack-protector-all -pedantic -D_GNU_SOURCE -DDEBUG_SESSION_CACHECFLAGS5,149
SRCS := $(filter-out genode_library_c.c, $(wildcard *.c))SRCS6,262
OBJS := $(SRCS:.c=.o)OBJS7,320
TCP_OBJ := TCP_layer.o proxy_tcp.oTCP_OBJ8,342
SSL_OBJS := $(filter-out $(TCP_OBJ), $(OBJS))SSL_OBJS10,378
BUILD_OBJS := $(addprefix $(BUILDDIR)/, $(SSL_OBJS))BUILD_OBJS11,424
TCP_OBJS := $(addprefix $(BUILDDIR)/, $(TCP_OBJ))TCP_OBJS12,477

proxy/cachessess.c,1218
kh_dynbuf_hash_func(dynbuf_t *b)kh_dynbuf_hash_func43,1706
#define kh_dynbuf_hash_equal(kh_dynbuf_hash_equal62,1980
cachessess_begin_cb(void)cachessess_begin_cb72,2272
cachessess_end_cb(void)cachessess_end_cb78,2353
cachessess_exist_cb(cache_iter_t it)cachessess_exist_cb84,2421
cachessess_del_cb(cache_iter_t it)cachessess_del_cb90,2509
cachessess_get_cb(cache_key_t key)cachessess_get_cb96,2607
cachessess_put_cb(cache_key_t key, int *ret)cachessess_put_cb102,2713
cachessess_free_key_cb(cache_key_t key)cachessess_free_key_cb108,2826
cachessess_free_val_cb(cache_val_t val)cachessess_free_val_cb114,2902
cachessess_get_key_cb(cache_iter_t it)cachessess_get_key_cb120,2985
cachessess_get_val_cb(cache_iter_t it)cachessess_get_val_cb126,3080
cachessess_set_val_cb(cache_iter_t it, cache_val_t val)cachessess_set_val_cb132,3168
cachessess_unpackverify_val_cb(cache_val_t val, int copy)cachessess_unpackverify_val_cb138,3279
cachessess_fini_cb(void)cachessess_fini_cb159,3711
cachessess_init_cb(cache_t *cache)cachessess_init_cb165,3784
cachessess_mkkey(const unsigned char *id, const size_t idlen)cachessess_mkkey185,4615
cachessess_mkval(SSL_SESSION *sess)cachessess_mkval191,4730

proxy/cache.h,2037
#define CACHE_HCACHE_H30,1472
typedef void * cache_val_t;cache_val_t36,1532
typedef void * cache_key_t;cache_key_t37,1560
typedef unsigned int cache_iter_t; /* must match khiter_t */cache_iter_t38,1588
typedef cache_iter_t (*cache_begin_cb_t)(void);cache_begin_cb_t40,1650
typedef cache_iter_t (*cache_end_cb_t)(void);cache_end_cb_t41,1698
typedef int (*cache_exist_cb_t)(cache_iter_t);cache_exist_cb_t42,1744
typedef void (*cache_del_cb_t)(cache_iter_t);cache_del_cb_t43,1791
typedef cache_iter_t (*cache_get_cb_t)(cache_key_t);cache_get_cb_t44,1837
typedef cache_iter_t (*cache_put_cb_t)(cache_key_t, int *);cache_put_cb_t45,1890
typedef void (*cache_free_key_cb_t)(cache_key_t);cache_free_key_cb_t46,1950
typedef void (*cache_free_val_cb_t)(cache_val_t);cache_free_val_cb_t47,2000
typedef cache_key_t (*cache_get_key_cb_t)(cache_iter_t);cache_get_key_cb_t48,2050
typedef cache_val_t (*cache_get_val_cb_t)(cache_iter_t);cache_get_val_cb_t49,2107
typedef void (*cache_set_val_cb_t)(cache_iter_t, cache_val_t);cache_set_val_cb_t50,2164
typedef cache_val_t (*cache_unpackverify_val_cb_t)(cache_val_t, int);cache_unpackverify_val_cb_t51,2227
typedef void (*cache_fini_cb_t)(void);cache_fini_cb_t52,2297
typedef struct cache {cache54,2337
	pthread_mutex_t mutex;mutex55,2360
	cache_begin_cb_t begin_cb;begin_cb57,2385
	cache_end_cb_t end_cb;end_cb58,2413
	cache_exist_cb_t exist_cb;exist_cb59,2437
	cache_del_cb_t del_cb;del_cb60,2465
	cache_get_cb_t get_cb;get_cb61,2489
	cache_put_cb_t put_cb;put_cb62,2513
	cache_free_key_cb_t free_key_cb;free_key_cb63,2537
	cache_free_val_cb_t free_val_cb;free_val_cb64,2571
	cache_get_key_cb_t get_key_cb;get_key_cb65,2605
	cache_get_val_cb_t get_val_cb;get_val_cb66,2637
	cache_set_val_cb_t set_val_cb;set_val_cb67,2669
	cache_unpackverify_val_cb_t unpackverify_val_cb;unpackverify_val_cb68,2701
	cache_fini_cb_t fini_cb;fini_cb69,2751
} cache_t;cache_t70,2777
typedef void (*cache_init_cb_t)(struct cache *);cache_init_cb_t72,2789

proxy/cachemgr.c,429
cache_t *cachemgr_fkcrt;cachemgr_fkcrt43,1680
cache_t *cachemgr_tgcrt;cachemgr_tgcrt44,1705
cache_t *cachemgr_ssess;cachemgr_ssess45,1730
cache_t *cachemgr_dsess;cachemgr_dsess46,1755
cachemgr_gc_thread(UNUSED void * arg)cachemgr_gc_thread53,1916
cachemgr_preinit(void)cachemgr_preinit65,2139
cachemgr_init(void)cachemgr_init92,2656
cachemgr_fini(void)cachemgr_fini107,3056
cachemgr_gc(void)cachemgr_gc122,3424

proxy/ssl.h,937
#define SSL_HSSL_H30,1470
#define OPENSSL_NO_THREADIDOPENSSL_NO_THREADID47,1955
#define OPENSSL_NO_TLSEXTOPENSSL_NO_TLSEXT50,2064
#define OPENSSL_NO_ECDHOPENSSL_NO_ECDH53,2169
#define OPENSSL_NO_ECDSAOPENSSL_NO_ECDSA56,2273
#define OPENSSL_NO_ECOPENSSL_NO_EC59,2375
#define CONST_SSL_METHOD CONST_SSL_METHOD67,2572
#define CONST_SSL_METHOD CONST_SSL_METHOD69,2637
#define SSL_get_certificate(SSL_get_certificate80,3087
#define SSL2_S SSL2_S85,3271
#define SSL2_S SSL2_S87,3339
#define SSL3_S SSL3_S90,3426
#define SSL3_S SSL3_S92,3478
#define TLS10_S TLS10_S95,3549
#define TLS10_S TLS10_S97,3603
#define TLS11_S TLS11_S100,3677
#define TLS11_S TLS11_S102,3733
#define TLS12_S TLS12_S105,3809
#define TLS12_S TLS12_S107,3865
#define SSL_PROTO_SUPPORT_S SSL_PROTO_SUPPORT_S109,3916
#define SSL_EC_KEY_CURVE_DEFAULT SSL_EC_KEY_CURVE_DEFAULT125,4369
#define SSL_X509_FPRSZ SSL_X509_FPRSZ143,5183

proxy/TCP_layer.c,659
proxy_ctx_new() {proxy_ctx_new20,390
nat_netfilter_lookup(struct sockaddr *dst_addr, socklen_t *dst_addrlen,nat_netfilter_lookup32,694
copydata(evutil_socket_t fd, short what, void* ptr){copydata52,1206
readcb(struct bufferevent *bev, void *ptr, int server) {readcb84,2324
cli_readcb(struct bufferevent *bev, void *ptr){cli_readcb101,2886
serv_readcb(struct bufferevent *bev, void *ptr){serv_readcb107,2994
writecb(struct bufferevent *bev, void *ptr) {writecb113,3103
eventcb(struct bufferevent *bev, short events, void *ptr){eventcb118,3207
accept_conn_cb(struct evconnlistener *listener,accept_conn_cb132,3620
int main(void)main177,5186

proxy/cert.c,541
cert_new(void)cert_new40,1592
cert_new3(EVP_PKEY *key, X509 *crt, STACK_OF(X509) *chain)cert_new357,1906
cert_new3_copy(EVP_PKEY *key, X509 *crt, STACK_OF(X509) *chain)cert_new3_copy76,2283
cert_new_load(const char *filename)cert_new_load99,2759
cert_refcount_inc(cert_t *c)cert_refcount_inc129,3263
cert_set_key(cert_t *c, EVP_PKEY *key)cert_set_key140,3469
cert_set_crt(cert_t *c, X509 *crt)cert_set_crt153,3691
cert_set_chain(cert_t *c, STACK_OF(X509) *chain)cert_set_chain166,3906
cert_free(cert_t *c)cert_free187,4329

proxy/cert.h,258
#define CERT_HCERT_H30,1471
typedef struct cert {cert37,1555
	EVP_PKEY *key;key38,1577
	X509 *crt;crt39,1593
	STACK_OF(X509) * chain;chain40,1605
	pthread_mutex_t mutex;mutex41,1630
	size_t references;references42,1654
} cert_t;cert_t43,1674

proxy/proxy_ssl.c,856
init_ssl_bio(SSL *ssl){init_ssl_bio9,127
pxy_dstssl_setup() {pxy_dstssl_setup32,740
notify_tcp() {notify_tcp80,2168
proxy_shutdown_free(struct proxy *proxy) {proxy_shutdown_free86,2234
#define MAYBE_UNUSEDMAYBE_UNUSED118,3260
#define MAYBE_UNUSED MAYBE_UNUSED120,3305
#undef MAYBE_UNUSEDMAYBE_UNUSED124,3424
pxy_ossl_sessnew_cb(MAYBE_UNUSED SSL *ssl, SSL_SESSION *sess)pxy_ossl_sessnew_cb123,3362
pxy_ossl_sessremove_cb(UNUSED SSL_CTX *sslctx, SSL_SESSION *sess)pxy_ossl_sessremove_cb155,4281
pxy_ossl_sessget_cb(UNUSED SSL *ssl, unsigned char *id, int idlen, int *copy)pxy_ossl_sessget_cb174,4749
pxy_srcsslctx_create(struct proxy *ctx, X509 *crt, STACK_OF(X509) *chain,pxy_srcsslctx_create199,5409
pxy_srcssl_create(struct proxy *proxy) {pxy_srcssl_create244,7287
pxy_srcssl_setup(struct proxy *proxy) {pxy_srcssl_setup280,8269

proxy/ssl.c,3925
struct cert_pkey_st {cert_pkey_st69,2425
	X509 *x509;x50970,2447
struct cert_st {cert_st76,2517
	struct cert_pkey_st *key;key77,2534
ssl_ssl_cert_get(SSL *s)ssl_ssl_cert_get85,2641
ssl_openssl_version(void)ssl_openssl_version97,2862
static int ssl_initialized = 0;ssl_initialized205,6860
struct CRYPTO_dynlock_value {CRYPTO_dynlock_value208,6916
	pthread_mutex_t mutex;mutex209,6946
static pthread_mutex_t *ssl_mutex;ssl_mutex211,6973
static int ssl_mutex_num;ssl_mutex_num212,7008
ssl_thr_locking_cb(int mode, int type, UNUSED const char *file,ssl_thr_locking_cb218,7101
ssl_thr_dyn_create_cb(UNUSED const char *file, UNUSED int line)ssl_thr_dyn_create_cb232,7446
ssl_thr_dyn_lock_cb(int mode, struct CRYPTO_dynlock_value *dl,ssl_thr_dyn_lock_cb246,7730
ssl_thr_dyn_destroy_cb(struct CRYPTO_dynlock_value *dl,ssl_thr_dyn_destroy_cb260,8036
ssl_thr_id_cb(void) {ssl_thr_id_cb272,8325
ssl_thr_id_cb(CRYPTO_THREADID *id)ssl_thr_id_cb280,8506
ssl_init(void)ssl_init292,8794
ssl_reinit(void)ssl_reinit373,10890
ssl_fini(void)ssl_fini390,11220
ssl_ssl_state_to_str(SSL *ssl)ssl_ssl_state_to_str428,12078
static unsigned char dh_g[] = { 0x02 };dh_g448,12741
static unsigned char dh512_p[] = {dh512_p449,12781
static unsigned char dh1024_p[] = {dh1024_p456,13208
static unsigned char dh2048_p[] = {dh2048_p468,14025
static unsigned char dh4096_p[] = {dh4096_p491,15621
ssl_tmp_dh_callback(UNUSED SSL *s, int is_export, int keylength)ssl_tmp_dh_callback541,18867
ssl_dh_load(const char *filename)ssl_dh_load584,19791
ssl_ec_by_name(const char *curvename)ssl_ec_by_name607,20171
ssl_x509_v3ext_add(X509V3_CTX *ctx, X509 *crt, char *k, char *v)ssl_x509_v3ext_add626,20531
ssl_x509_v3ext_copy_by_nid(X509 *crt, X509 *origcrt, int nid)ssl_x509_v3ext_copy_by_nid648,21088
ssl_rand(void *p, size_t sz)ssl_rand670,21519
ssl_x509_serial_copyrand(X509 *dstcrt, X509 *srccrt)ssl_x509_serial_copyrand693,22092
ssl_x509_forge(X509 *cacrt, EVP_PKEY *cakey, X509 *origcrt,ssl_x509_forge731,23112
ssl_x509chain_load(X509 **crt, STACK_OF(X509) **chain, const char *filename)ssl_x509chain_load874,27487
ssl_x509chain_use(SSL_CTX *sslctx, X509 *crt, STACK_OF(X509) *chain)ssl_x509chain_use944,28860
ssl_x509_load(const char *filename)ssl_x509_load964,29346
ssl_key_load(const char *filename)ssl_key_load999,30016
ssl_key_genrsa(const int keysize)ssl_key_genrsa1033,30654
ssl_x509_subject(X509 *crt)ssl_x509_subject1051,31041
ssl_x509_subject_cn(X509 *crt, size_t *psz)ssl_x509_subject_cn1062,31305
ssl_x509_fingerprint_sha1(X509 *crt, unsigned char *fpr)ssl_x509_fingerprint_sha11088,31881
ssl_dh_refcount_inc(DH *dh)ssl_dh_refcount_inc1101,32148
ssl_key_refcount_inc(EVP_PKEY *key)ssl_key_refcount_inc1116,32455
ssl_x509_refcount_inc(X509 *crt)ssl_x509_refcount_inc1131,32885
ssl_dnsname_match(const char *certname, size_t certnamesz,ssl_dnsname_match1167,34439
ssl_wildcardify(const char *hostname)ssl_wildcardify1196,35359
ssl_x509_names_match(X509 *crt, const char *dnsname)ssl_x509_names_match1217,35834
ssl_x509_names(X509 *crt)ssl_x509_names1267,37140
ssl_x509_names_to_str(X509 *crt)ssl_x509_names_to_str1332,38657
ssl_ia5string_strdup(ASN1_IA5STRING *ia5)ssl_ia5string_strdup1374,39312
ssl_x509_aias(X509 *crt, const int type)ssl_x509_aias1394,39771
ssl_x509_ocsps(X509 *crt)ssl_x509_ocsps1433,40764
ssl_x509_is_valid(X509 *crt)ssl_x509_is_valid1443,40947
ssl_x509_to_str(X509 *crt)ssl_x509_to_str1458,41268
ssl_x509_to_pem(X509 *crt)ssl_x509_to_pem1485,41734
ssl_session_to_str(SSL_SESSION *sess)ssl_session_to_str1512,42192
ssl_session_is_valid(SSL_SESSION *sess)ssl_session_is_valid1538,42691
ssl_is_ocspreq(const unsigned char *buf, size_t sz)ssl_is_ocspreq1560,43189
ssl_tls_clienthello_parse_sni(const unsigned char *buf, ssize_t *sz)ssl_tls_clienthello_parse_sni1602,44845
#define DBG_printf(DBG_printf1605,44940

proxy/cachetgcrt.c,1065
cachetgcrt_begin_cb(void)cachetgcrt_begin_cb47,1862
cachetgcrt_end_cb(void)cachetgcrt_end_cb53,1940
cachetgcrt_exist_cb(cache_iter_t it)cachetgcrt_exist_cb59,2005
cachetgcrt_del_cb(cache_iter_t it)cachetgcrt_del_cb65,2090
cachetgcrt_get_cb(cache_key_t key)cachetgcrt_get_cb71,2183
cachetgcrt_put_cb(cache_key_t key, int *ret)cachetgcrt_put_cb77,2284
cachetgcrt_free_key_cb(cache_key_t key)cachetgcrt_free_key_cb83,2392
cachetgcrt_free_val_cb(cache_val_t val)cachetgcrt_free_val_cb89,2461
cachetgcrt_get_key_cb(cache_iter_t it)cachetgcrt_get_key_cb95,2542
cachetgcrt_get_val_cb(cache_iter_t it)cachetgcrt_get_val_cb101,2634
cachetgcrt_set_val_cb(cache_iter_t it, cache_val_t val)cachetgcrt_set_val_cb107,2719
cachetgcrt_unpackverify_val_cb(cache_val_t val, int copy)cachetgcrt_unpackverify_val_cb113,2827
cachetgcrt_fini_cb(void)cachetgcrt_fini_cb123,2979
cachetgcrt_init_cb(cache_t *cache)cachetgcrt_init_cb129,3047
cachetgcrt_mkkey(const char *keycn)cachetgcrt_mkkey149,3873
cachetgcrt_mkval(cert_t *valcrt)cachetgcrt_mkval155,3949

proxy/cachedsess.h,42
#define CACHEDSESS_HCACHEDSESS_H30,1477

proxy/khash.h,3035
#define __AC_KHASH_H__AC_KHASH_H118,3396
#define AC_VERSION_KHASH_H AC_VERSION_KHASH_H126,3468
typedef unsigned int khint32_t;khint32_t135,3632
typedef unsigned long khint32_t;khint32_t137,3695
typedef unsigned long khint64_t;khint64_t141,3764
typedef unsigned long long khint64_t;khint64_t143,3803
#define kh_inline kh_inline148,3883
#define kh_inline kh_inline150,3916
typedef khint32_t khint_t;khint_t154,3972
typedef khint_t khiter_t;khiter_t155,3999
#define __ac_isempty(__ac_isempty157,4026
#define __ac_isdel(__ac_isdel158,4088
#define __ac_iseither(__ac_iseither159,4148
#define __ac_set_isdel_false(__ac_set_isdel_false160,4211
#define __ac_set_isempty_false(__ac_set_isempty_false161,4285
#define __ac_set_isboth_false(__ac_set_isboth_false162,4361
#define __ac_set_isdel_true(__ac_set_isdel_true163,4436
#define __ac_fsize(__ac_fsize165,4507
#define kroundup32(kroundup32168,4572
#define kcalloc(kcalloc172,4699
#define kmalloc(kmalloc175,4755
#define krealloc(krealloc178,4808
#define kfree(kfree181,4864
static const double __ac_HASH_UPPER = 0.77;__ac_HASH_UPPER184,4897
#define __KHASH_TYPE(__KHASH_TYPE186,4942
#define __KHASH_PROTOTYPES(__KHASH_PROTOTYPES194,5142
#define __KHASH_IMPL(__KHASH_IMPL203,5641
#define KHASH_DECLARE(KHASH_DECLARE349,12283
#define KHASH_INIT2(KHASH_INIT2353,12431
#define KHASH_INIT(KHASH_INIT357,12654
#define kh_int_hash_func(kh_int_hash_func367,13007
#define kh_int_hash_equal(kh_int_hash_equal371,13116
#define kh_int64_hash_func(kh_int64_hash_func377,13305
#define kh_int64_hash_equal(kh_int64_hash_equal381,13445
static kh_inline khint_t __ac_X31_hash_string(const char *s)__ac_X31_hash_string387,13635
#define kh_str_hash_func(kh_str_hash_func398,13985
#define kh_str_hash_equal(kh_str_hash_equal402,14107
static kh_inline khint_t __ac_Wang_hash(khint_t key)__ac_Wang_hash404,14160
#define kh_int_hash_func2(kh_int_hash_func2414,14381
#define khash_t(khash_t424,14603
#define kh_init(kh_init431,14804
#define kh_destroy(kh_destroy438,15007
#define kh_clear(kh_clear445,15246
#define kh_resize(kh_resize453,15489
#define kh_put(kh_put466,16046
#define kh_get(kh_get475,16407
#define kh_del(kh_del483,16694
#define kh_exist(kh_exist491,16977
#define kh_key(kh_key499,17238
#define kh_val(kh_val508,17549
#define kh_value(kh_value513,17638
#define kh_begin(kh_begin520,17838
#define kh_end(kh_end527,18029
#define kh_size(kh_size534,18266
#define kh_n_buckets(kh_n_buckets541,18497
#define kh_foreach(kh_foreach550,18828
#define kh_foreach_value(kh_foreach_value564,19312
#define KHASH_SET_INIT_INT(KHASH_SET_INIT_INT577,19690
#define KHASH_MAP_INIT_INT(KHASH_MAP_INIT_INT585,19980
#define KHASH_SET_INIT_INT64(KHASH_SET_INIT_INT64592,20246
#define KHASH_MAP_INIT_INT64(KHASH_MAP_INIT_INT64600,20549
typedef const char *kh_cstr_t;kh_cstr_t603,20685
#define KHASH_SET_INIT_STR(KHASH_SET_INIT_STR608,20849
#define KHASH_MAP_INIT_STR(KHASH_MAP_INIT_STR616,21143

proxy/log.c,539
static int err_mode = LOG_ERR_MODE_STDERR;err_mode58,2001
log_err_writecb(UNUSED void *fh, const void *buf, size_t sz)log_err_writecb61,2060
log_err_printf(const char *fmt, ...)log_err_printf74,2322
log_err_mode(int mode)log_err_mode91,2580
static int dbg_mode = LOG_DBG_MODE_NONE;dbg_mode103,2766
log_dbg_write_free(void *buf, size_t sz)log_dbg_write_free106,2812
log_dbg_print_free(char *s)log_dbg_print_free117,2967
log_dbg_printf(const char *fmt, ...)log_dbg_printf123,3050
log_dbg_mode(int mode)log_dbg_mode141,3305

proxy/proxy_tcp.c,241
find_next_slot(struct proxy_ctx *ctx) {find_next_slot7,105
pxy_conn_new(struct proxy_ctx *ctx) {pxy_conn_new23,512
pxy_conn_free(struct pxy_conn *ctx){pxy_conn_free42,998
proxy_ctx_free(struct proxy_ctx * ctx) {proxy_ctx_free54,1203

proxy/log.h,252
#define LOG_HLOG_H30,1470
#define LOG_ERR_MODE_STDERR LOG_ERR_MODE_STDERR37,1601
#define LOG_ERR_MODE_SYSLOG LOG_ERR_MODE_SYSLOG38,1631
#define LOG_DBG_MODE_NONE LOG_DBG_MODE_NONE44,1809
#define LOG_DBG_MODE_ERRLOG LOG_DBG_MODE_ERRLOG45,1837

proxy/cachessess.h,42
#define CACHESSESS_HCACHESSESS_H30,1477

proxy/cachefkcrt.c,1180
kh_x509fpr_hash_func(void *b)kh_x509fpr_hash_func42,1716
#define kh_x509fpr_hash_equal(kh_x509fpr_hash_equal53,1917
cachefkcrt_begin_cb(void)cachefkcrt_begin_cb62,2171
cachefkcrt_end_cb(void)cachefkcrt_end_cb68,2249
cachefkcrt_exist_cb(cache_iter_t it)cachefkcrt_exist_cb74,2314
cachefkcrt_del_cb(cache_iter_t it)cachefkcrt_del_cb80,2399
cachefkcrt_get_cb(cache_key_t key)cachefkcrt_get_cb86,2492
cachefkcrt_put_cb(cache_key_t key, int *ret)cachefkcrt_put_cb92,2593
cachefkcrt_free_key_cb(cache_key_t key)cachefkcrt_free_key_cb98,2701
cachefkcrt_free_val_cb(cache_val_t val)cachefkcrt_free_val_cb104,2770
cachefkcrt_get_key_cb(cache_iter_t it)cachefkcrt_get_key_cb110,2851
cachefkcrt_get_val_cb(cache_iter_t it)cachefkcrt_get_val_cb116,2943
cachefkcrt_set_val_cb(cache_iter_t it, cache_val_t val)cachefkcrt_set_val_cb122,3028
cachefkcrt_unpackverify_val_cb(cache_val_t val, int copy)cachefkcrt_unpackverify_val_cb128,3136
cachefkcrt_fini_cb(void)cachefkcrt_fini_cb140,3337
cachefkcrt_init_cb(cache_t *cache)cachefkcrt_init_cb146,3405
cachefkcrt_mkkey(X509 *keycrt)cachefkcrt_mkkey166,4231
cachefkcrt_mkval(X509 *valcrt)cachefkcrt_mkval177,4408

proxy/attrib.h,453
#define ATTRIB_HATTRIB_H30,1473
#define __attribute__(__attribute__46,1853
#define UNUSED UNUSED49,1887
#define NORET NORET50,1935
#define PRINTF(PRINTF51,1985
#define SCANF(SCANF52,2049
#define WUNRES WUNRES53,2112
#define MALLOC MALLOC54,2172
#define NONNULL(NONNULL55,2227
#define PURE PURE56,2289
#define likely(likely65,2494
#define unlikely(unlikely66,2525
#define likely(likely68,2562
#define unlikely(unlikely69,2614

proxy/cache.c,394
cache_new(cache_init_cb_t init_cb)cache_new43,1639
cache_reinit(cache_t *cache)cache_reinit61,1878
cache_free(cache_t *cache)cache_free71,2049
cache_gc(cache_t *cache)cache_gc87,2362
cache_get(cache_t *cache, cache_key_t key)cache_get107,2790
cache_set(cache_t *cache, cache_key_t key, cache_val_t val)cache_set132,3288
cache_del(cache_t *cache, cache_key_t key)cache_del151,3636

proxy/cachemgr.h,698
#define CACHEMGR_HCACHEMGR_H30,1475
#define cachemgr_fkcrt_get(cachemgr_fkcrt_get48,1858
#define cachemgr_fkcrt_set(cachemgr_fkcrt_set50,1949
#define cachemgr_fkcrt_del(cachemgr_fkcrt_del52,2068
#define cachemgr_tgcrt_get(cachemgr_tgcrt_get55,2160
#define cachemgr_tgcrt_set(cachemgr_tgcrt_set57,2251
#define cachemgr_tgcrt_del(cachemgr_tgcrt_del59,2370
#define cachemgr_ssess_get(cachemgr_ssess_get62,2462
#define cachemgr_ssess_set(cachemgr_ssess_set64,2571
#define cachemgr_ssess_del(cachemgr_ssess_del69,2802
#define cachemgr_dsess_get(cachemgr_dsess_get74,2991
#define cachemgr_dsess_set(cachemgr_dsess_set76,3118
#define cachemgr_dsess_del(cachemgr_dsess_del79,3309

proxy/proxy_ssl.h,1164
#define MAXCONNS MAXCONNS4,47
struct ssl_channel {ssl_channel5,70
    int conns;conns6,91
    X509 *cacrt; // store the cacrt for all server ssl connectioncacrt7,106
    EVP_PKEY *cakey; // store the ca keycakey8,172
    EVP_PKEY *key; // store the public key for all fake certificate.key9,213
    STACK_OF(X509) *chain;// store the ca chain.chain10,282
    struct proxy * proxies[MAXCONNS];proxies11,331
    struct shm_ctx_t *shm_ctx;shm_ctx12,369
struct proxy {proxy15,404
    int client_received;client_received16,419
    int server_send;server_send17,444
    struct ssl_channel *ctx;ctx18,465
    X509 *origcrt;origcrt19,494
    int index;index20,513
    char * sni;sni21,528
    SSL *cli_ssl;cli_ssl22,544
    SSL *serv_ssl;serv_ssl23,562
    unsigned char client_hello_buf[1024];client_hello_buf24,581
    ssize_t hello_msg_length;hello_msg_length25,623
    bool SNI_parsed;SNI_parsed26,653
    bool client_handshake_done;client_handshake_done27,674
    bool server_handshake_done;server_handshake_done28,706
    int msgs_need_to_out;msgs_need_to_out29,738
    unsigned char *down_pointer;down_pointer30,764

proxy/dynbuf.h,158
#define DYNBUF_HDYNBUF_H30,1473
typedef struct dynbuf {dynbuf36,1533
	unsigned char *buf;buf37,1557
	size_t sz;sz38,1578
} dynbuf_t;dynbuf_t39,1590

proxy/constants.h,31
#define MAXCONNS MAXCONNS1,0

proxy/cachedsess.c,1234
kh_dynbuf_hash_func(dynbuf_t *b)kh_dynbuf_hash_func45,1769
#define kh_dynbuf_hash_equal(kh_dynbuf_hash_equal64,2043
cachedsess_begin_cb(void)cachedsess_begin_cb74,2335
cachedsess_end_cb(void)cachedsess_end_cb80,2416
cachedsess_exist_cb(cache_iter_t it)cachedsess_exist_cb86,2484
cachedsess_del_cb(cache_iter_t it)cachedsess_del_cb92,2572
cachedsess_get_cb(cache_key_t key)cachedsess_get_cb98,2670
cachedsess_put_cb(cache_key_t key, int *ret)cachedsess_put_cb104,2776
cachedsess_free_key_cb(cache_key_t key)cachedsess_free_key_cb110,2889
cachedsess_free_val_cb(cache_val_t val)cachedsess_free_val_cb116,2965
cachedsess_get_key_cb(cache_iter_t it)cachedsess_get_key_cb122,3048
cachedsess_get_val_cb(cache_iter_t it)cachedsess_get_val_cb128,3143
cachedsess_set_val_cb(cache_iter_t it, cache_val_t val)cachedsess_set_val_cb134,3231
cachedsess_unpackverify_val_cb(cache_val_t val, int copy)cachedsess_unpackverify_val_cb140,3342
cachedsess_fini_cb(void)cachedsess_fini_cb161,3774
cachedsess_init_cb(cache_t *cache)cachedsess_init_cb167,3847
cachedsess_mkkey(const struct sockaddr *addr, UNUSED const socklen_t addrlen,cachedsess_mkkey187,4678
cachedsess_mkval(SSL_SESSION *sess)cachedsess_mkval221,5609

proxy/shm_and_sem.h,484
key_t key_up = 1000;key_up10,208
key_t key_down = 1001;key_down11,229
#define SHMSZ SHMSZ12,252
#define BUFSZ BUFSZ13,272
struct timeval msec = {0, 1};msec15,293
struct shm_ctx_t {shm_ctx_t18,382
    int shmid_up;shmid_up19,401
    int shmid_down;shmid_down20,419
    unsigned char *up_channel;up_channel21,439
    unsigned char *down_channel;down_channel22,466
int init_shm(struct shm_ctx_t *shm_ctx){init_shm26,500
destroy_shm(struct shm_ctx_t *shm_ctx) {destroy_shm57,1330

proxy/proxy_tcp.h,648
struct pxy_conn {pxy_conn4,44
    int closed;closed5,62
    struct sockaddr_storage dstsock;dstsock6,78
    socklen_t dstsocklen;dstsocklen7,115
    int index;index8,141
    struct bufferevent *cli_bev;cli_bev9,156
    struct bufferevent *serv_bev;serv_bev10,189
    struct event *timer;timer11,223
    struct shm_ctx_t *shm_ctx;shm_ctx12,248
    struct proxy_ctx *parent;parent13,279
struct proxy_ctx {proxy_ctx16,313
    int counts;counts17,332
    struct pxy_conn * conns[MAXCONNS];conns18,348
    struct shm_ctx_t *shm_ctx;shm_ctx19,387
    struct event *timer;timer20,418
    struct event_base *base;base21,443

proxy/cachefkcrt.h,42
#define CACHEFKCRT_HCACHEFKCRT_H30,1477

proxy/dynbuf.c,307
dynbuf_new_alloc(size_t sz)dynbuf_new_alloc43,1736
dynbuf_new_copy(const unsigned char *buf, const size_t sz)dynbuf_new_copy61,2005
dynbuf_new_file(const char *filename)dynbuf_new_file81,2406
dynbuf_new(unsigned char *buf, size_t sz)dynbuf_new117,3003
dynbuf_free(dynbuf_t *db)dynbuf_free132,3216

bin/index.html,0

bin/route.sh,0

bin/clean.c,184
char UP_SEM[]= "up";UP_SEM4,68
char DOWN_SEM[]= "down";DOWN_SEM5,89
char LOCK_SEM[]= "lock";LOCK_SEM6,114
char READ_LOCK[] = "readlock";READ_LOCK7,139
int main() {main10,172

bin/setup.sh,0
